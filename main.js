!function(t){var e={};function n(c){if(e[c])return e[c].exports;var i=e[c]={i:c,l:!1,exports:{}};return t[c].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,c){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:c})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var c=Object.create(null);if(n.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(c,i,function(e){return t[e]}.bind(null,i));return c},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){},function(t,e,n){"use strict";n.r(e);n(0);function c(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((c,i)=>{const r=new XMLHttpRequest;r.addEventListener("load",()=>{if(r.status>=200&&r.status<300)try{const t=JSON.parse(r.responseText);c(t)}catch(t){i(console.error(t))}}),r.open(t,e),r.send(n)})}var i=n.p+"1015a4735108376c1442ada462a12a6a.svg",r=n.p+"5963db93dbdac2132d3f4dd802e1eafa.svg";const a=document.querySelector(".header .btn"),s=document.querySelector(".ticket__add"),o=s.querySelector(".ticket__form"),l=s.querySelector(".ticket__form .ticket__name"),d=s.querySelector(".ticket__form .ticket__description"),u=document.querySelector(".tickets");let p=null;const _=t=>{t.preventDefault(),l.value="",d.value="",s.classList.remove("active"),o.classList.remove("active")},v=t=>{t.preventDefault();const e=new FormData;e.append("id",""+(null===p?"null":p.id)),e.append("name",l.value),e.append("description",d.value),e.append("status",""+(null===p?"null":"true"===p.status?"true":"false")),e.append("created","null"),c("post","http://localhost:7070?method=createTicket",e).then(()=>{p=null,k.renderTickets(),l.value="",d.value="",s.classList.remove("active"),o.classList.remove("active")})},m=function(t){t.preventDefault(),t.stopPropagation();const e=s.querySelector(".ticket__title");s.classList.add("active"),o.classList.add("active");const n=s.querySelector(".btn__cansel"),i=s.querySelector(".btn__add");if(n.addEventListener("click",_),i.addEventListener("click",v),e.textContent="Добавить тикет",null!==this.closest(".tickets__item")){const t=this.closest(".tickets__item");e.textContent="Изменить тикет",c("get","http://localhost:7070?method=ticketById&id="+t.getAttribute("data-id")).then(t=>{p=t,l.value=t.name,d.value=t.description})}},k=new class{constructor(t,e){this.tickets=t,this.PopUpHandler=e}renderTickets(){this.tickets.innerHTML="",c("get","http://localhost:7070?method=allTickets").then(t=>{t.forEach(t=>{const e=this.createTicket(t),n=e.querySelector(".item__status"),c=e.querySelector(".item__delete"),i=e.querySelector(".img__idit");n.addEventListener("click",this.callBackCheckMark),c.addEventListener("click",this.callbackDeleteTicket),i.addEventListener("click",this.PopUpHandler),e.addEventListener("click",this.callBackTicketClick),this.tickets.append(e)})})}createTicket(t){const e=document.createElement("div");return e.classList.add("tickets__item"),e.dataset.id=t.id,e.innerHTML=`\n        <button class="circle item__status">\n        <img\n                src="${i}" alt="checkmark"\n                class="img__status" ${this.isHidden(t.status)}></button>\n        <div class="item__content"><span class="content_name">${t.name}</span></div>\n        <span class="item__date">${t.created}</span>\n        <button class="circle item__edit"><img\n                src="${r}" alt="edit"\n                class="img__idit"></button>\n        <button class="circle item__delete">X</button>\n        `,e}isHidden(t){if("true"!==t)return"hidden"}callBackCheckMark(t){t.preventDefault(),t.stopPropagation();const e=t.currentTarget.querySelector("img");e.hidden?e.hidden=!1:e.hidden=!0,c("get","http://localhost:7070?method=ticketById&id="+t.currentTarget.parentNode.getAttribute("data-id")).then(t=>{t.status=""+!e.hidden;const n=new FormData;for(const e in t)n.append(e,t[e]);c("POST","http://localhost:7070?method=updateTicket",n)})}callbackDeleteTicket(t){t.preventDefault(),t.stopPropagation();const e=document.createElement("div"),n=t.currentTarget.closest(".tickets__item");e.classList.add("ticket__add","active"),e.innerHTML='\n            <div class="ticket__form active">\n            <h3 class="ticket__title">Удалить тикет</h3>\n            <div class="ticket__wrapper">\n                <p class="ticket__input-description">Вы уверены, что хотите удалить тикет? Это действие необратимо.</p>\n            </div>\n            <div class="ticket__btns">\n                <button class="btn btn__cansel">Отмена</button>\n                <button class="btn btn__add">Ок</button>\n            </div>\n\n            </div>';const i=e.querySelector(".btn__cansel"),r=e.querySelector(".btn__add");i.addEventListener("click",t=>{t.preventDefault(),e.remove()}),r.addEventListener("click",t=>{t.preventDefault(),c("DELETE","http://localhost:7070?method=deleteTicket&id="+n.getAttribute("data-id")).then(t=>{!0===t.status&&(e.remove(),n.remove())})}),document.body.append(e)}callBackTicketClick(t){t.preventDefault();let e=t.currentTarget.querySelector(".content__description");if(console.log(e),null===e){console.log(t.currentTarget.getAttribute("data-id"));const n=t.currentTarget.querySelector(".item__content");c("get","http://localhost:7070?method=ticketById&id="+t.currentTarget.getAttribute("data-id")).then(t=>{e=document.createElement("span"),e.classList.add("content__description"),e.textContent=t.description,n.append(e)})}else e.remove()}}(u,m);k.renderTickets(),a.addEventListener("click",m)}]);
//# sourceMappingURL=main.js.map